<!DOCTYPE html>
<html lang="zh-cn">
<!-- 
	文件创建日期：2023/8/5
	GitHub仓库：http://github.com/guguan123/guguan123.github.io/blob/main/Gaokao_Countdown.html
	原网站链接：http://226000.xyz/
-->
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>时间不多了！</title>
	<!--[if lt IE 9]>
		<script src="https://cdn.bootcdn.net/ajax/libs/html5shiv/3.7.3/html5shiv.js"></script>
	<![endif]-->
	<!-- 备用图标链接：https://guguan123.github.io/images/wifi-for_[226000.xyz].png -->
	<link rel="icon" type="image/png" href="https://s1.imagehub.cc/images/2023/09/29/wifi-for_226000.xyz.png">
	<style>
		html, body {
			margin: 0;
			padding: 0;
			height: 100%;
			
		}

		.gray-half,
		.white-half {
			height: 100%;
		}
		
		.gray-half {
			/* 设置背景图片 */
			/* 备用背景图片链接：https://guguan123.github.io/images/bg-for_[226000.xyz].jpg */
			background-image: url("https://s1.imagehub.cc/images/2023/09/28/bg.jpeg");
			background-size: cover;
			background-repeat: no-repeat;
			background-position: center center;
		}

		.white-half {
			flex: 1;
			display: flex;
			flex-direction: column;
			justify-content: center;
			align-items: center;
		}

		.white-half .footer {
			position: absolute;
			bottom: 0;
			font-size: 13px; /* 字体大小 */
		}

		.Main_text{
			color: purple;
		}

		.pageContent{
			margin-block-start: 1em;
			margin-block-end: 1em;
			margin-inline-start: 0px;
			margin-inline-end: 0px;
		}

		@media (min-width: 768px) { /* 如果屏幕宽度大于等于768px */
			.container {
				width: 50%;
				height: 100%;
				float: left;
			}
		}

		@media (max-width: 767px) { /* 如果屏幕宽度小于768px */
			.container {
				height: 50%;
				display: flex;
				flex-direction: column;
			}

			.gray-half,
			.white-half {
				width: 100%;
			}
		}

		@media (prefers-color-scheme: dark) {
			/* 适配黑暗模式 */
			body {
				background-color: #242424;
			}
			.Main_text{
				color: #E066FF;
			}
			.white-half .footer{
				color: #f5f5f5;
			}
			.maxim {
				color: #f5f5f5;
			}
			.NetlifyURL {
				color: #E066FF;
			}
		}

		/*@media (min-width: 768px) and (min-height: 280px) {
			/* 当窗口分辨率的宽度大于768且长度大于280时（正常的电脑屏幕） */
			/*.pageContent{
				display: block;
			}
			
			.Main_text{
				margin-block-start: 1em;
				margin-block-end: 1em;
			}
		}*/

		@media (min-width: 768px) and (max-height: 279px) {
			/* 当窗口分辨率的宽度大于768且长度小于280时（较小的电脑屏幕） */
			.pageContent {
				display: none;
			}

			.Main_text{
				margin-block-start: 0;
				margin-block-end: 0;
			}
		}

		@media (max-width: 767px) and (min-width: 628px) and (max-height: 499px) {
			/* 当窗口分辨率宽度小于768且大于628，并且长度小于500时（较小的平板屏幕） */
			/* 此时已经更改为移动设备样式，且 class="maxim" 可以保持一行 */
			.pageContent {
				display: none;
			}

			.Main_text{
				margin-block-start: 0;
				margin-block-end: 0;
			}
		}

		@media (max-width: 627px) and (min-width: 410px) and (max-height: 529px) {
			/* 宽度小于628且大于410，并且长度小于530时（更小的平板屏幕） */
			/* 此时已经更改为移动设备样式，且 class="maxim" 可以保持两行 */
			.pageContent {
				display: none;
			}

			.Main_text{
				margin-block-start: 0;
				margin-block-end: 0;
			}

			.h1 {
				font-size: 1em;
			}
		}

		@media (max-width: 409px) and (max-height: 719px) {
			/* 分辨率宽度小于410且长度小于720时 */

			#countdown {
				margin-block-start: 0;
				margin-block-end: 0;
			}

			.pageContent {
				display: none;
			}

			.Main_text{
				margin-block-start: 0;
				margin-block-end: 0;
			}

			.white-half .footer {
				position: absolute;
				bottom: 0;
				font-size: 7px; /* 字体大小 */
			}
		}

		@media (max-width: 369px) and (max-height: 439px) {
			.maxim {
				display: none;
			}
		}

		@media (max-width: 349px) and (max-height: 559px) {
			.maxim {
				display: none;
			}
		}

		@media (max-width: 767px) and (max-height: 389px) {
			.maxim {
				display: none;
			}
		}
	</style>

	<!-- Clarity tracking code for https://guguan.us.kg/ -->
	<script>
		(function(c,l,a,r,i,t,y){
			c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
			t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i+"?ref=bwt";
			y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
		})(window, document, "clarity", "script", "qwm2cpd5ks");
	</script>
</head>
<body>
	<div class="container">
		<div class="gray-half"></div>
	</div>
	<div class="container">
		<div class="white-half">
			<h1 class="Main_text" id="countdownText">
				距离高考还有
				<div id="countdown">警告：倒计时无法在较旧或者不支持 JavaScript 的浏览器下运行</div>
			</h1>
			<p class="pageContent"></p>
			<p class="maxim">吾尝终日而思矣，不如须臾之所学也。吾尝跂而望矣，不如登高之博见也。——《劝学》</p>
			<div class="footer">
				联系方式：<i>guguan123@outlook.com</i>
				<br>
				© 2023 Not right reserved.&nbsp;自豪地不由<a href="https://netlify.com" target="_blank" rel="noopener" class="NetlifyURL">Netlify</a>强力驱动.&nbsp;<a href="http://wapmz.com/in/49"><img src="http://wapmz.com/cn/small/49" alt="wapmz.com"></a>
			</div>
		</div>
	</div>
	<script>
		const examDate = new Date("2024-06-07 09:00");
		const examTime = examDate.getTime();
		const threshold = 30 * 1000; // 30秒
		const apiConfigs = [
			{
				url: "https://worldtimeapi.org/api/timezone/Asia/Shanghai",
				type: "json",
				parse: data => new Date(data.datetime).getTime()
			},
			{
				url: "https://f.m.suning.com/api/ct.do",
				type: "json",
				parse: data => new Date(data.currentTime).getTime()
			},
			{
				url: "https://cloudflare.com/cdn-cgi/trace",
				type: "ini",
				parse: text => {
					// 解析INI格式，提取ts字段
					const match = text.match(/^ts=(\d+(\.\d+)?)/m);
					return match ? Number(match[1]) * 1000 : null;
				}
			}
		];
		const countdownEl = document.getElementById("countdown");
		const countdownTextEl = document.getElementById("countdownText");

		let useOnlineTime = false;
		let onlineTime = null;
		let tickCount = 0;

		async function fetchOnlineTime() {
			const fetches = apiConfigs.map(cfg =>
				fetch(cfg.url)
					.then(res => cfg.type === "json" ? res.json() : res.text())
					.then(data => cfg.parse(data))
					.catch(() => null)
			);
			const results = await Promise.all(fetches);
			return results.find(ts => typeof ts === "number" && !isNaN(ts)) || null;
		}

		async function calibrateTime() {
			const online = await fetchOnlineTime();
			console.log("Online time: " + online)
			if (online) {
				const local = Date.now();
				useOnlineTime = Math.abs(online - local) > threshold;
				onlineTime = online;
			} else {
				useOnlineTime = false;
				onlineTime = null;
			}
		}

		function getNow() {
			if (useOnlineTime && onlineTime !== null) {
				onlineTime += 1000;
				return onlineTime;
			}
			return Date.now();
		}

		function formatCountdown(diff) {
			if (diff <= 0) return "倒计时结束";
			const days = Math.floor(diff / 86400);
			const hours = Math.floor((diff % 86400) / 3600);
			const minutes = Math.floor((diff % 3600) / 60);
			const seconds = Math.floor(diff % 60);
			return `${days}天${hours}小时${minutes}分钟${seconds}秒`;
		}

		async function startCountdown() {
			await calibrateTime();
			setInterval(async () => {
				tickCount++;
				if (tickCount % 30 === 0) await calibrateTime();
				const now = getNow();
				const diff = Math.floor((examTime - now) / 1000);
				const text = formatCountdown(diff);
				if (diff > 0) {
					countdownEl.textContent = text;
				} else {
					countdownTextEl.textContent = text;
				}
			}, 1000);
		}

		startCountdown();
	</script>
</body>
</html>
